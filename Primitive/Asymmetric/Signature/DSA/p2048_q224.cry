module Primitive::Asymmetric::Signature::DSA::p2048_q224=
    Primitive::Asymmetric::Signature::DSA::DSA where
import Common::utils
import Primitive::Keyless::Hash::SHA1
import Primitive::Keyless::Hash::keccak

type L = 2048 // p length
type N = 224 // qlength

type p = 30654023714034275781583914056319119181557364617019414971927796056816405746039129472490078331976188154450868732628186555673073241783237300256430802875268509995496292394179285796641226106506334009835041931007683511361052953177998085421139447896486714996921968240245266474829277020575242214990651962607433684010412348821710581714920166914908112463836372666803582204809819071568874559816993634390496773922707441278798806431849227925669125705789734829738774326395056474475049942122771744721069296080339792029576261815147903279987711547046263301986321771247675148524215773848673052552853288850101146414637308758455432050917

type q = 13479973333575319898435899287355906005519936792850505415798798758321

g = BVtoZ `{p} 0xe3a93c09da6f560e4d483a382a4c546f2335c36a4c35ac1463c08a3e6dd415df56fdc537f25fd5372be63e4f5300780b782f1acd01c8b4eb33414615fd0ea82573acba7ef83f5a943854151afc2d7dfe121fb8cd03335b065b549c5dcc606be9052483bc284e12ac3c8dba09b426e08402030e70bc1cc2bf8957c4ba0630f3f32ad689389ac47443176063f247d9e2296b3ea5b5bc2335828ea1a080ed35918dee212fd031279d1b894f01afec523833669eac031a420e540ba1320a59c424a3e5849a460a56bcb001647885b1433c4f992971746bfe2977ce7259c550b551a6c35761e4a41af764e8d92132fcc0a59d1684eab90d863f29f41cf7578faa908c

// Add some test vectors

testCase0 = {
Msg = BVtoZ `{q} (sha1 (split 0xedc6fd9b6c6e8a59f283016f7f29ee16deeaa609b5737927162aef34fed985d0bcb550275637ba67831a2d4efccb35296dfe730f4a0b4f4728d1d7d1bb8f4a36238a5c94311fa1134a93a6b4de39c085e9f60ae4e237c0416d58042bb36baa38cba8c896295b745d5376fd8ce42eb6ee5a1b38f87716b265b76e58cfb24a9170)),
X = BVtoZ `{q} 0x6132e551cdac88409183bd37ee1452cd247d4834b08814b275be3ff5,
Y = BVtoZ `{p} 0x289ff18c32a56bb0b8839370647683a38a5a7e291410b93207212adc8088d30f93e9e4abc523f3d46936e7d5c90d88742b36afd37563408f15c8c1a4f7ac24bf05f01008ffee70c8825d57c3a9308bad8a095af2b53b2dda3cbed846d95e301eb9b84766415d11f6c33209a0d28571096ab04a79aa0dc465997529686b68e887cd8a205c2dc8195aef0422eba9979f549ac85548e419413643b7244361153ada1480d238cd00dc16527938955548dd5d027ded1029eeeb8ed6c61b4cd59341d8b15466e9da890a989996f4d7691e6072de136af28b5874bf08bd1f8a60cfb1c00888132909f515e04bce81b02951aa41baac68ffdb8c5dc77a1d32d8f2c10dd7,
K = BVtoZ `{q} 0x7197392d32d0af6a7183cc3398556f8f687d86a8ff742be6ad38562f
}

//if |digest|>N then take MSBs of message digest upto q size, i.e., N

testCase1 = {
Msg = BVtoZ `{q} (take`{N}(SHA_3_256 0xedc6fd9b6c6e8a59f283016f7f29ee16deeaa609b5737927162aef34fed985d0bcb550275637ba67831a2d4efccb35296dfe730f4a0b4f4728d1d7d1bb8f4a36238a5c94311fa1134a93a6b4de39c085e9f60ae4e237c0416d58042bb36baa38cba8c896295b745d5376fd8ce42eb6ee5a1b38f87716b265b76e58cfb24a9170)),
X = BVtoZ `{q} 0x6132e551cdac88409183bd37ee1452cd247d4834b08814b275be3ff5,
Y = BVtoZ `{p} 0x289ff18c32a56bb0b8839370647683a38a5a7e291410b93207212adc8088d30f93e9e4abc523f3d46936e7d5c90d88742b36afd37563408f15c8c1a4f7ac24bf05f01008ffee70c8825d57c3a9308bad8a095af2b53b2dda3cbed846d95e301eb9b84766415d11f6c33209a0d28571096ab04a79aa0dc465997529686b68e887cd8a205c2dc8195aef0422eba9979f549ac85548e419413643b7244361153ada1480d238cd00dc16527938955548dd5d027ded1029eeeb8ed6c61b4cd59341d8b15466e9da890a989996f4d7691e6072de136af28b5874bf08bd1f8a60cfb1c00888132909f515e04bce81b02951aa41baac68ffdb8c5dc77a1d32d8f2c10dd7,
K = BVtoZ `{q} 0x7197392d32d0af6a7183cc3398556f8f687d86a8ff742be6ad38562f
}
