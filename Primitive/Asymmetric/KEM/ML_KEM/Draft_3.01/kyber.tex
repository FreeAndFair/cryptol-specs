% @copyright Galois Inc
% @author Marios Georgiou <marios@galois.com>

\documentclass{article}
\usepackage{etex}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

\usepackage[letterpaper,margin=1in]{geometry}

\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{mathtools}
\usepackage{mathtools}
\usepackage{xspace}
\usepackage{algorithm,algpseudocode}
\usepackage{tikz}
\usepackage{verbatim}
\usepackage{fancyvrb}
\DefineVerbatimEnvironment{code}{Verbatim}{frame=single, samepage=true, gobble=2, numbers=left, framerule=0.8mm}
\usetikzlibrary{positioning}
\usepackage{booktabs,multicol,ctable}

\usepackage{comment}
\usepackage{afterpage}

\usepackage{relsize}

\usepackage{caption}
\captionsetup[table]{skip=10pt}

\usepackage[hyphens]{url}
\usepackage{xcolor}
\definecolor{linkcolor}{rgb}{0.65,0,0}
\definecolor{darkgreen}{rgb}{0,0.65,0}
\definecolor{urlcolor}{rgb}{0,0,0.65}
\usepackage[colorlinks=true, backref=page, linkcolor=linkcolor, urlcolor=urlcolor, citecolor=darkgreen]{hyperref}
%\usepackage[capitalize]{cleveref} % Must be loaded last
%\theoremstyle{acmdefinition}
\newtheorem{theorem}{Theorem}
\newtheorem{remark}{Remark}

\newcommand{\todo}[1]{\textcolor{red}{ {\bf TODO: }{#1} } }

\def\subheading#1{\medskip\noindent{\boldmath\textbf{#1}}~\ignorespaces}

\renewcommand{\algorithmicrequire}{\textbf{Input:}}
\renewcommand{\algorithmicensure}{\textbf{Output:}}

\input{macros}
\usepackage{cleveref}
\title{\textbf{{\sc CRYSTALS-\Kyber}} \\ \ \\ Algorithm Specifications And Supporting Documentation\\[0.2em]\smaller{}(version 3.01)}

\author{Roberto Avanzi, Joppe Bos, Léo Ducas, Eike Kiltz, Tancrède Lepoint,\\
 Vadim Lyubashevsky, John M. Schanck, Peter Schwabe, Gregor Seiler, Damien Stehlé}

\date{\today}

\begin{document}

\maketitle

\section{Written specification}\label{sec:spec}
\begin{code}
  module kyber where

  import kyber512

  ZeroTestVector : Bit
  property ZeroTestVector = flag
    where
      (pk,sk) = CGen(zero, zero)
      (c, K) = CEnc(pk, zero)
      flag = c == groupBy`{8} 0x6bdb330ddb7b513c80dd8fccbd31877cd05cd866b49f7c113698c285aa2b949278d24d54fefd1190aaf8aabaf70b93a40274f9b3fff36dc83dc0f210b6a10a539b50ca3ccac3c894ab1dff31cc6d5f7fe1dfc08fb6f42b4ccc404e8104e4a64e7f04b8efd67fda5346b21545468c37cbcda44c7a11475ce95be9da618fa899d1f778e05535f161f47b4a9df94f6ade8d0401a9d678d5ada8a248336eb35ef37e935d4e2569cc4d89fac7d67144f7bc3183991c911428e13b827ff90fed5d4e6a68ade42f5941f9ab68e03cc2c712fcd226b3012d00ac96cdefe1e5f60981311d92ed825ff91953f3763b509594f56d47b803c8e3263b3e4fde8a1b1d5b61e5f9dd666a2439910f56b5f6e4b64f3430a6f5362c5655c6f71e16b145e9d7d60d98ba01b59d254b0c6e73e87c572b716a024d6e3298cc7fe1a4a5a61628d723027317f3676b172bc15cc8bb2171b72b722edf9b5a17e0ed8bcb18af24fa422f9d4cee273a27f9feaa3e13d703f399c095a63ecda25620c12df0a2281bf50c4a37ff87ae33f8a1aab8ec015a499e31e810bf479b1fa8850a9e6e13501412dc47668c61e81a4526bebc8d4bf3d260343a69c4c5be31fa0b7ab1687ee239428d24c5dd7118f7339fe18d78d2944a051026c30e4ef5562a702178cff8d857c80e9c8b90f978f3da1006214c980aa6bb209402a6922762572f9b70c0892456f7cc57c687e2a576083b254e3387772e01b99da56912f57730e501b8598f23c7c9f05f7c5dd4514bd710c6ec72a76db5e2265a158082a2923ceec38979c421ffd62b86d8c16ad77445b18b929d9d56bb83b876e6b87c109560484a9e73878b7cb5ad42f469f9c7b3323b01889332c66e84a195db7b0646245adc2680fa3565a76ff983d3a0b267038602bf12a1f7d42239f0b37c0bd5d4e0f80538e413d1c6f6484d69c52a87f4c735070c7cf710db188e851e90a36f0c6625fc79fd0925ffa9cecbb419bed79b016981345dc7fa33a41d1d375d177e528f2c8380f7b63e962cb415f6177dd7e833a0829f6fb181e5c1d8c5cf0e635dcaab9f61211dec71a5bf255ef953a9

\end{code}
\input{specification}

\bibliographystyle{plain}
\bibliography{collection}

\end{document}
